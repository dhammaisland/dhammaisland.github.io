<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<!-- Favicon - ä½¿ç”¨ SVG æ ¼å¼çš„èŠ±æœµå›¾æ ‡ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path fill='%238d5a2a' d='M6.174 1.184a2 2 0 0 1 3.652 0A2 2 0 0 1 12.99 3.01a2 2 0 0 1 1.826 3.164 2 2 0 0 1 0 3.652 2 2 0 0 1-1.826 3.164 2 2 0 0 1-3.164 1.826 2 2 0 0 1-3.652 0A2 2 0 0 1 3.01 12.99a2 2 0 0 1-1.826-3.164 2 2 0 0 1 0-3.652A2 2 0 0 1 3.01 3.01a2 2 0 0 1 3.164-1.826M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4'/></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="ä½›æ•™ å—ä¼ ä½›æ•™ åŸå§‹ä½›æ•™ ä¸Šåº§éƒ¨ä½›æ•™ ä½›é™€çš„æ­£æ³• é˜¿å«ç» å·´åˆ©ä¸‰è— ç¦…ä¿® è‡ªæ´²è‡ªä¾ æ³•æ´²æ³•ä¾ æ­£æ³•å¾‹ å·´åˆ©ç»å…¸ åˆ«è¯‘æ‚é˜¿å« å°¼æŸ¯è€¶ é•¿éƒ¨ ä¸­éƒ¨ ç›¸åº”éƒ¨ å¢æ”¯éƒ¨ å°éƒ¨" />
    <meta name="description" content="æ³•æ´²æ³•ä¾ï¼Œè‡ªæ´²è‡ªä¾ï¼Œåˆ†äº«ä½›é™€æ­£æ³•ã€å¾‹ã€ç¦…å¸ˆæ³•è¯­ã€ç¦…ä¿®ç»éªŒï¼Œä¹¦ç±æ¨èã€ä¸‹è½½ï¼Œèµ„æºå…±äº«" />
    <title>æ³•æ´²</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dharma-brown': '#8d5a2a',
                        'dharma-light': '#a67c52',
                        'dharma-bg': '#fdfbf7',
                    }
                }
            }
        }
    </script>
    <style>
        .highlight {
            background-color: #fef3c7;
            padding: 0 2px;
            font-weight: 500;
        }
        
        .dhamma-text {
            transition: opacity 0.3s ease;
        }
        
        .type-filter.active {
            background-color: #8d5a2a !important;
            border-color: #8d5a2a !important;
            color: white !important;
        }
    </style>
</head>
<body class="bg-dharma-bg font-sans">
    <!-- Header -->
    <header class="bg-gradient-to-r from-dharma-brown to-dharma-light text-white py-10 px-4 shadow-lg">
        <h1 class="text-4xl md:text-5xl font-light tracking-widest text-center mb-2"><i class="bi bi-flower1"></i>æ³•æ´²</h1>
        <p class="text-center text-sm md:text-base opacity-95">åˆ†äº«ä½›æ³•æ™ºæ…§ä¸ä¿®è¡Œèµ„æº</p>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- æ³•è¯­å±•ç¤ºåŒº -->
        <section class="bg-white rounded-lg shadow-md p-6 md:p-10 mb-12 border-l-4 border-dharma-brown">
            <h2 class="text-2xl md:text-3xl font-normal text-dharma-brown mb-6 flex items-center gap-2">
                <i class="bi bi-flower1"></i>
                <span>æ³•è¯­ç”˜éœ²</span>
            </h2>
            
            <!-- æœç´¢æ¡† -->
            <div class="flex flex-wrap gap-2 mb-6">
                <input 
                    type="text" 
                    id="search-input" 
                    class="flex-1 min-w-[200px] px-4 py-3 border-2 border-gray-200 rounded-full text-base outline-none transition-all duration-300 focus:border-dharma-brown focus:ring-2 focus:ring-dharma-brown focus:ring-opacity-20" 
                    placeholder="è¾“å…¥å…³é”®è¯æœç´¢æ³•è¯­..." 
                    onkeypress="if(event.key==='Enter') searchDhamma()"
                >
                <button 
                    class="px-6 py-3 bg-dharma-brown text-white rounded-full hover:bg-dharma-light transition-all duration-300 shadow-sm hover:shadow-md font-medium flex items-center gap-1"
                    onclick="searchDhamma()"
                >
                    <i class="bi bi-search"></i> æœç´¢
                </button>
                <button 
                    class="px-6 py-3 bg-white text-dharma-brown border-2 border-dharma-brown rounded-full hover:bg-dharma-brown hover:text-white transition-all duration-300 font-medium flex items-center gap-1"
                    onclick="clearSearch()" 
                    id="clear-btn" 
                    style="display:none;"
                >
                    <i class="bi bi-x-circle"></i> æ¸…é™¤
                </button>
            </div>
            
            <!-- é¡µç è·³è½¬ -->
            <div class="flex flex-wrap gap-2 mb-6 items-center justify-center">
                <label for="page-jump" class="text-sm text-gray-600">è·³è½¬åˆ°ç¬¬</label>
                <input 
                    type="number" 
                    id="page-jump" 
                    min="1"
                    class="w-20 px-3 py-2 border-2 border-gray-200 rounded-lg text-center outline-none transition-all duration-300 focus:border-dharma-brown focus:ring-2 focus:ring-dharma-brown focus:ring-opacity-20" 
                    placeholder="1"
                    onkeypress="if(event.key==='Enter') jumpToPage()"
                >
                <label for="page-jump" class="text-sm text-gray-600">é¡µ</label>
                <button 
                    class="px-4 py-2 bg-dharma-brown text-white rounded-lg hover:bg-dharma-light transition-all duration-300 shadow-sm hover:shadow-md text-sm font-medium flex items-center gap-1"
                    onclick="jumpToPage()"
                >
                    <i class="bi bi-arrow-right-circle"></i> è·³è½¬
                </button>
            </div>
            
            <!-- æœç´¢ç»“æœä¿¡æ¯ -->
            <div id="search-info" class="text-gray-600 text-sm text-center mb-4 py-2 bg-blue-50 rounded-lg" style="display:none;"></div>
            
            <!-- æ³•è¯­å†…å®¹ -->
            <div class="min-h-[200px] flex items-center justify-center">
                <div id="dhamma-display" class="dhamma-text text-lg md:text-xl leading-relaxed text-gray-800 text-justify w-full">
                    <div class="text-center text-gray-400">åŠ è½½ä¸­...</div>
                </div>
            </div>
            
            <!-- åˆ†é¡µæ§åˆ¶ -->
            <div class="flex flex-col sm:flex-row justify-between items-center mt-8 pt-6 border-t border-gray-200 gap-4">
                <div class="flex gap-2 items-center order-1 sm:order-none">
                    <button 
                        id="prev-btn" 
                        onclick="prevPage()"
                        class="px-4 py-2 bg-white border border-gray-300 text-dharma-brown rounded-lg hover:bg-dharma-brown hover:text-white hover:border-dharma-brown transition-all duration-200 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:text-dharma-brown disabled:hover:border-gray-300 flex items-center gap-1"
                    >
                        <i class="bi bi-chevron-left"></i> ä¸Šé¡µ
                    </button>
                    <span class="page-info text-gray-600 text-sm mx-2" id="page-info">-</span>
                    <button 
                        id="next-btn" 
                        onclick="nextPage()"
                        class="px-4 py-2 bg-white border border-gray-300 text-dharma-brown rounded-lg hover:bg-dharma-brown hover:text-white hover:border-dharma-brown transition-all duration-200 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:text-dharma-brown disabled:hover:border-gray-300 flex items-center gap-1"
                    >
                        ä¸‹é¡µ <i class="bi bi-chevron-right"></i>
                    </button>
                </div>
                <button 
                    class="px-6 py-2 bg-white border border-dharma-brown text-dharma-brown rounded-full hover:bg-dharma-brown hover:text-white transition-all duration-300 order-2 sm:order-none flex items-center gap-1"
                    onclick="randomQuote()"
                >
                    <i class="bi bi-shuffle"></i> éšæœºç¿»é¡µ
                </button>
            </div>
        </section>

        <!-- æ–‡ç« ä¸“æ åŒº -->
        <section class="mb-12">
            <h2 class="text-2xl md:text-3xl font-normal text-dharma-brown mb-6 text-center flex items-center justify-center gap-2">
                <i class="bi bi-journal-text"></i>
                <span>æ³•ä¹‰æ–‡ç« </span>
            </h2>
            
            <!-- æ–‡ç« åˆ—è¡¨ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- æ–‡ç« å¡ç‰‡ 1 -->
                <a href="article/å››å¤§æ³•æ•™.html" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1 group">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-600 rounded-lg flex items-center justify-center text-white">
                                <i class="bi bi-file-text text-2xl"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium text-dharma-brown mb-2 group-hover:text-dharma-light transition-colors">å…³äºå››å¤§æ³•æ•™</h3>
                            <p class="text-sm text-gray-500 mb-2 line-clamp-2">å¢æ”¯éƒ¨AN VII.80ç»æ–‡è§£è¯»ï¼Œæ¸…æ™°å®šä¹‰æ³•ä¸å¾‹çš„æ ‡å‡†</p>
                            <div class="flex items-center gap-2 text-xs text-gray-400">
                                <i class="bi bi-tag"></i>
                                <span>æ³•æ•™ Â· ç»å…¸</span>
                            </div>
                        </div>
                    </div>
                </a>
                
                <!-- æ–‡ç« å¡ç‰‡ 2 -->
                <a href="article/åœ£è€…ä¸å‡¡å¤«çš„ä¸åŒè§†è§’.html" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1 group">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white">
                                <i class="bi bi-eye text-2xl"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium text-dharma-brown mb-2 group-hover:text-dharma-light transition-colors">åœ£è€…ä¸å‡¡å¤«çš„ä¸åŒè§†è§’</h3>
                            <p class="text-sm text-gray-500 mb-2 line-clamp-2">ç›¸åº”éƒ¨35ç›¸åº”80ç»è§£è¯»ï¼Œæ–­é™¤æ— æ˜çš„çŸ¥è§</p>
                            <div class="flex items-center gap-2 text-xs text-gray-400">
                                <i class="bi bi-tag"></i>
                                <span>æ— æ˜ Â· å…­æ ¹</span>
                            </div>
                        </div>
                    </div>
                </a>
                
                <!-- æ–‡ç« å¡ç‰‡ 3 -->
                <a href="article/å¿ƒç”Ÿè¿«åˆ‡æ„Ÿ.html" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1 group">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center text-white">
                                <i class="bi bi-heart-pulse text-2xl"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium text-dharma-brown mb-2 group-hover:text-dharma-light transition-colors">å¿ƒç”Ÿè¿«åˆ‡æ„Ÿ</h3>
                            <p class="text-sm text-gray-500 mb-2 line-clamp-2">ç­è¿ªè¾¾å¤§å¸ˆå¼€ç¤ºï¼Œæ— å¸¸ä¸æ— è´¢äº§çš„çœŸç›¸</p>
                            <div class="flex items-center gap-2 text-xs text-gray-400">
                                <i class="bi bi-tag"></i>
                                <span>æ— å¸¸ Â· ç¦…ä¿®</span>
                            </div>
                        </div>
                    </div>
                </a>
                
                <!-- æ–‡ç« å¡ç‰‡ 4 -->
                <a href="article/å¦‚ä½•è¯æœ.html" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1 group">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center text-white">
                                <i class="bi bi-trophy text-2xl"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium text-dharma-brown mb-2 group-hover:text-dharma-light transition-colors">å¦‚ä½•è¯æœ</h3>
                            <p class="text-sm text-gray-500 mb-2 line-clamp-2">èˆåˆ©å¼—å°Šè€…å¼€ç¤ºå¦‚ç†ä½œæ„äº”å–è•´ä»¥è¯å¾—åœ£æœ</p>
                            <div class="flex items-center gap-2 text-xs text-gray-400">
                                <i class="bi bi-tag"></i>
                                <span>äº”å–è•´ Â· è¯æœ</span>
                            </div>
                        </div>
                    </div>
                </a>
                
                <!-- æ–‡ç« å¡ç‰‡ 5 -->
                <a href="article/å†…è§‚å®š.html" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1 group">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-lg flex items-center justify-center text-white">
                                <i class="bi bi-droplet text-2xl"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium text-dharma-brown mb-2 group-hover:text-dharma-light transition-colors">å†…è§‚å®š</h3>
                            <p class="text-sm text-gray-500 mb-2 line-clamp-2">å¾·åŠ å°¼äºšç¦…å¸ˆå¼€ç¤ºå†…è§‚å®šä¸æ­¢ç¦…å®šçš„åŒºåˆ«</p>
                            <div class="flex items-center gap-2 text-xs text-gray-400">
                                <i class="bi bi-tag"></i>
                                <span>å†…è§‚å®š Â· æ­£ç²¾è¿›</span>
                            </div>
                        </div>
                    </div>
                </a>
                
                <!-- æ–‡ç« å¡ç‰‡ 6 -->
                <a href="article/äº²è¿‘æ™ºè€….html" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1 group">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-gradient-to-br from-rose-500 to-pink-600 rounded-lg flex items-center justify-center text-white">
                                <i class="bi bi-people text-2xl"></i>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium text-dharma-brown mb-2 group-hover:text-dharma-light transition-colors">äº²è¿‘æ™ºè€…</h3>
                            <p class="text-sm text-gray-500 mb-2 line-clamp-2">è©ææ¯”ä¸˜å¼€ç¤ºå–„å‹å¯¹çµæ€§å‘å±•çš„é‡è¦æ€§</p>
                            <div class="flex items-center gap-2 text-xs text-gray-400">
                                <i class="bi bi-tag"></i>
                                <span>å–„çŸ¥è¯† Â· å¤§å‰ç¥¥ç»</span>
                            </div>
                        </div>
                    </div>
                </a>
                
                <!-- å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šæ–‡ç«  -->
            </div>
        </section>

        <!-- ä¹¦ç±ä¸‹è½½åŒº -->
        <section class="mb-12">
            <h2 class="text-2xl md:text-3xl font-normal text-dharma-brown mb-6 text-center flex items-center justify-center gap-2">
                <i class="bi bi-book"></i>
                <span>æ¨èä¹¦ç±ä¸‹è½½</span>
            </h2>
            
            <!-- ä¹¦ç±ç½‘æ ¼ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="books-grid">
                <div class="text-center text-gray-400 col-span-full py-8">åŠ è½½ä¸­...</div>
            </div>
        </section>

        <!-- èµ„æºé“¾æ¥åŒº -->
        <section class="mb-12">
            <h2 class="text-2xl md:text-3xl font-normal text-dharma-brown mb-6 text-center flex items-center justify-center gap-2">
                <i class="bi bi-link-45deg"></i>
                <span>ä½›æ³•èµ„æºé“¾æ¥</span>
            </h2>
            
            <!-- ç±»å‹è¿‡æ»¤å™¨ -->
            <div class="flex justify-center gap-3 mb-8 flex-wrap" id="type-filters">
                <button class="type-filter px-6 py-2 bg-white border-2 border-gray-200 text-gray-700 rounded-full hover:border-dharma-light transition-all duration-300 active:bg-dharma-brown active:border-dharma-brown active:text-white" data-type="all" onclick="filterByType('all')">
                    å…¨éƒ¨
                </button>
            </div>
            
            <!-- é“¾æ¥ç½‘æ ¼ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="links-grid">
                <div class="text-center text-gray-400 col-span-full py-8">åŠ è½½ä¸­...</div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 py-6 text-center text-gray-600 text-sm mt-12">
        <p>&copy; 2025 æ³•æ´² | æ„¿æ­£æ³•ä¹…ä½</p>
    </footer>

    <script src="link.js"></script>
    <script src="dhamma.js"></script>
    <script src="book.js"></script>
    <script>
        let dhammaData = DHAMMA_DATA;
        let linksData = LINKS_DATA;
        let currentPage = 0;
        let currentFilter = 'all';
        const ITEMS_PER_PAGE = 5;
        
        // æœç´¢ç›¸å…³å˜é‡
        let searchKeyword = '';
        let filteredDhammaData = [];
        let isSearching = false;
        
        // éšæœºæ˜¾ç¤ºç›¸å…³å˜é‡
        let randomIndices = [];

        // ç”Ÿæˆéšæœºç´¢å¼•æ•°ç»„
        function generateRandomIndices(dataLength) {
            const indices = Array.from({ length: dataLength }, (_, i) => i);
            // Fisher-Yates æ´—ç‰Œç®—æ³•
            for (let i = indices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [indices[i], indices[j]] = [indices[j], indices[i]];
            }
            return indices;
        }

        // é¡µé¢åŠ è½½ååˆå§‹åŒ–
        function initPage() {
            // ç”Ÿæˆéšæœºç´¢å¼•(ä»…åœ¨éæœç´¢æ¨¡å¼ä¸‹)
            if (!isSearching) {
                randomIndices = generateRandomIndices(dhammaData.length);
            }
            
            // åˆå§‹åŒ–æ³•è¯­æ˜¾ç¤º
            displayDhamma();
            
            // æ˜¾ç¤ºä¹¦ç±
            displayBooks();
            
            // åˆå§‹åŒ–åˆ†ç±»è¿‡æ»¤å™¨
            initTypeFilters();
            
            // æ˜¾ç¤ºé“¾æ¥
            displayLinks();
        }

        // æ˜¾ç¤ºå½“å‰é¡µæ³•è¯­
        function displayDhamma() {
            const dataSource = isSearching ? filteredDhammaData : dhammaData;
            if (dataSource.length === 0) {
                document.getElementById('dhamma-display').innerHTML = '<div style="text-align:center;color:#999;">æœªæ‰¾åˆ°åŒ¹é…çš„æ³•è¯­</div>';
                document.getElementById('page-info').textContent = 'æ— ç»“æœ';
                document.getElementById('prev-btn').disabled = true;
                document.getElementById('next-btn').disabled = true;
                return;
            }
            
            const display = document.getElementById('dhamma-display');
            let items;
            
            if (isSearching) {
                // æœç´¢æ¨¡å¼:æŒ‰é¡ºåºæ˜¾ç¤ºæœç´¢ç»“æœ
                const startIdx = currentPage * ITEMS_PER_PAGE;
                const endIdx = Math.min(startIdx + ITEMS_PER_PAGE, dataSource.length);
                items = dataSource.slice(startIdx, endIdx);
            } else {
                // éæœç´¢æ¨¡å¼:ä½¿ç”¨éšæœºç´¢å¼•
                const startIdx = currentPage * ITEMS_PER_PAGE;
                const endIdx = Math.min(startIdx + ITEMS_PER_PAGE, randomIndices.length);
                items = randomIndices.slice(startIdx, endIdx).map(idx => ({
                    text: dhammaData[idx].sentence,
                    url: dhammaData[idx].url,
                    index: idx
                }));
            }
            
            display.style.opacity = '0';
            setTimeout(() => {
                // ä½¿ç”¨ç¼–å·åˆ—è¡¨æ˜¾ç¤ºå¤šæ¡æ³•è¯­,å¸¦å…³é”®è¯é«˜äº®
                display.innerHTML = items.map((item, idx) => {
                    const text = item.text || item.sentence || item;
                    const url = item.url || '';
                    const highlightedText = isSearching ? highlightKeyword(text, searchKeyword) : text;
                    const actualIdx = item.index !== undefined ? item.index : currentPage * ITEMS_PER_PAGE + idx;
                    
                    let content = `<div style="margin-bottom: 1.5rem; padding-bottom: 1.5rem; ${idx < items.length - 1 ? 'border-bottom: 1px solid #e0e0e0;' : ''}">
                        <div style="color: #a67c52; font-size: 0.85rem; margin-bottom: 0.5rem;">ç¬¬ ${actualIdx + 1} æ¡</div>
                        <div>${highlightedText}</div>`;
                    
                    if (url && url !== '') {
                        content += `<div style="margin-top: 0.75rem;"><a href="${url}" style="color: #8d5a2a; text-decoration: none; font-size: 0.9rem; border-bottom: 1px solid #8d5a2a;" target="_blank">ğŸ“– é˜…è¯»æ›´å¤š</a></div>`;
                    }
                    
                    content += `</div>`;
                    return content;
                }).join('');
                
                display.style.opacity = '1';
            }, 150);
            
            // æ›´æ–°é¡µç ä¿¡æ¯
            const totalPages = Math.ceil(dataSource.length / ITEMS_PER_PAGE);
            document.getElementById('page-info').textContent = `ç¬¬ ${currentPage + 1} é¡µ / å…± ${totalPages} é¡µ`;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('prev-btn').disabled = currentPage === 0;
            document.getElementById('next-btn').disabled = (currentPage + 1) * ITEMS_PER_PAGE >= dataSource.length;
        }

        function prevPage() {
            if (currentPage > 0) {
                currentPage--;
                displayDhamma();
                scrollToTop();
            }
        }

        function nextPage() {
            const dataSource = isSearching ? filteredDhammaData : dhammaData;
            const totalPages = Math.ceil(dataSource.length / ITEMS_PER_PAGE);
            if (currentPage < totalPages - 1) {
                currentPage++;
                displayDhamma();
                scrollToTop();
            }
        }
        
        function scrollToTop() {
            document.querySelector('.dhamma-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function randomQuote() {
            if (isSearching) {
                // æœç´¢æ¨¡å¼:éšæœºè·³è½¬åˆ°æŸé¡µ
                const totalPages = Math.ceil(filteredDhammaData.length / ITEMS_PER_PAGE);
                currentPage = Math.floor(Math.random() * totalPages);
            } else {
                // éæœç´¢æ¨¡å¼:é‡æ–°ç”Ÿæˆéšæœºç´¢å¼•å¹¶è·³è½¬åˆ°éšæœºé¡µ
                randomIndices = generateRandomIndices(dhammaData.length);
                const totalPages = Math.ceil(dhammaData.length / ITEMS_PER_PAGE);
                currentPage = Math.floor(Math.random() * totalPages);
            }
            displayDhamma();
            scrollToTop();
        }
        
        // æœç´¢åŠŸèƒ½
        function searchDhamma() {
            const searchInput = document.getElementById('search-input');
            const keyword = searchInput.value.trim();
            
            if (!keyword) {
                clearSearch();
                return;
            }
            
            searchKeyword = keyword;
            isSearching = true;
            
            // è¿‡æ»¤åŒ…å«å…³é”®è¯çš„æ³•è¯­,ä¿ç•™åŸå§‹ç´¢å¼•
            filteredDhammaData = dhammaData
                .map((item, index) => ({ text: item.sentence, url: item.url, index }))
                .filter(item => item.text.toLowerCase().includes(keyword.toLowerCase()));
            
            // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
            currentPage = 0;
            
            // æ˜¾ç¤ºæœç´¢ç»“æœä¿¡æ¯
            const searchInfo = document.getElementById('search-info');
            searchInfo.textContent = `æ‰¾åˆ° ${filteredDhammaData.length} æ¡åŒ…å«"${keyword}"çš„æ³•è¯­`;
            searchInfo.style.display = 'block';
            
            // æ˜¾ç¤ºæ¸…é™¤æŒ‰é’®
            document.getElementById('clear-btn').style.display = 'inline-block';
            
            // æ›´æ–°æ˜¾ç¤º
            displayDhamma();
        }
        
        // æ¸…é™¤æœç´¢
        function clearSearch() {
            searchKeyword = '';
            isSearching = false;
            filteredDhammaData = [];
            currentPage = 0;
            
            // é‡æ–°ç”Ÿæˆéšæœºç´¢å¼•
            randomIndices = generateRandomIndices(dhammaData.length);
            
            // éšè—æœç´¢ä¿¡æ¯
            document.getElementById('search-info').style.display = 'none';
            document.getElementById('clear-btn').style.display = 'none';
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById('search-input').value = '';
            
            // æ›´æ–°æ˜¾ç¤º
            displayDhamma();
        }
        
        // é«˜äº®å…³é”®è¯
        function highlightKeyword(text, keyword) {
            if (!keyword) return text;
            
            const regex = new RegExp(`(${keyword})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }
        
        // è·³è½¬åˆ°æŒ‡å®šé¡µ
        function jumpToPage() {
            const input = document.getElementById('page-jump');
            const pageNum = parseInt(input.value);
            
            if (!pageNum || pageNum < 1) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é¡µç ');
                return;
            }
            
            const dataSource = isSearching ? filteredDhammaData : dhammaData;
            const totalPages = Math.ceil(dataSource.length / ITEMS_PER_PAGE);
            
            if (pageNum > totalPages) {
                alert(`é¡µç è¶…å‡ºèŒƒå›´ï¼Œå½“å‰å…± ${totalPages} é¡µ`);
                return;
            }
            
            currentPage = pageNum - 1;
            displayDhamma();
            scrollToTop();
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            input.value = '';
        }

        // åˆå§‹åŒ–ç±»å‹è¿‡æ»¤å™¨
        function initTypeFilters() {
            const types = [...new Set(linksData.map(link => link.type))].filter(t => t !== null).sort();
            const typeNames = {
                1: '<i class="bi bi-book"></i> ç»å…¸æ–‡çŒ®',
                2: '<i class="bi bi-mic"></i> å¼€ç¤ºè®²åº§',
                3: '<i class="bi bi-globe"></i> ç»¼åˆèµ„æº'
            };
            
            const filtersContainer = document.getElementById('type-filters');
            
            types.forEach(type => {
                const btn = document.createElement('button');
                btn.className = 'type-filter px-6 py-2 bg-white border-2 border-gray-200 text-gray-700 rounded-full hover:border-dharma-light transition-all duration-300 cursor-pointer flex items-center gap-1';
                btn.dataset.type = type;
                btn.innerHTML = typeNames[type] || `ç±»å‹ ${type}`;
                btn.onclick = () => filterByType(type);
                filtersContainer.appendChild(btn);
            });
        }

        function filterByType(type) {
            currentFilter = type;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.type-filter').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type == type || (type === 'all' && btn.dataset.type === 'all'));
            });
            
            displayLinks();
        }

        // æ˜¾ç¤ºä¹¦ç±
        function displayBooks() {
            const grid = document.getElementById('books-grid');
            
            if (typeof BOOKS_DATA === 'undefined' || !BOOKS_DATA || BOOKS_DATA.length === 0) {
                grid.innerHTML = '<div class="text-center text-gray-400 col-span-full py-8">æš‚æ— ä¹¦ç±</div>';
                return;
            }
            
            grid.innerHTML = BOOKS_DATA.map(book => {
                return `
                    <div class="bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-transparent hover:border-dharma-brown hover:-translate-y-1">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0">
                                <div class="w-16 h-20 bg-gradient-to-br from-dharma-brown to-dharma-light rounded flex items-center justify-center text-white">
                                    <i class="bi bi-book text-3xl"></i>
                                </div>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-medium text-dharma-brown mb-1 line-clamp-2">${book.title}</h3>
                                ${book.author ? `<p class="text-sm text-gray-600 mb-2"><i class="bi bi-person"></i> ${book.author}</p>` : ''}
                                ${book.description ? `<p class="text-sm text-gray-500 mb-3 line-clamp-2">${book.description}</p>` : ''}
                                <div class="flex gap-2 flex-wrap">
                                    ${book.download ? `<a href="${book.download}" class="inline-flex items-center gap-1 px-3 py-1 bg-dharma-brown text-white text-sm rounded-full hover:bg-dharma-light transition-colors" download>
                                        <i class="bi bi-download"></i> ä¸‹è½½
                                    </a>` : ''}
                                    ${book.online ? `<a href="${book.online}" target="_blank" class="inline-flex items-center gap-1 px-3 py-1 bg-white border border-dharma-brown text-dharma-brown text-sm rounded-full hover:bg-dharma-brown hover:text-white transition-colors">
                                        <i class="bi bi-eye"></i> åœ¨çº¿é˜…è¯»
                                    </a>` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // æ˜¾ç¤ºé“¾æ¥
        function displayLinks() {
            const grid = document.getElementById('links-grid');
            
            const filteredLinks = currentFilter === 'all' 
                ? linksData 
                : linksData.filter(link => link.type == currentFilter);
            
            if (filteredLinks.length === 0) {
                grid.innerHTML = '<div class="text-center text-gray-400 col-span-full py-8">æš‚æ— èµ„æº</div>';
                return;
            }
            
            grid.innerHTML = filteredLinks.map(link => {
                const typeConfig = {
                    1: { name: 'ç»å…¸', color: '#059669', bgColor: '#d1fae5', borderColor: '#059669' },  // ç»¿è‰² - ç»å…¸æ–‡çŒ®
                    2: { name: 'å¼€ç¤º', color: '#dc2626', bgColor: '#fee2e2', borderColor: '#dc2626' },  // çº¢è‰² - å¼€ç¤ºè®²åº§
                    3: { name: 'èµ„æº', color: '#2563eb', bgColor: '#dbeafe', borderColor: '#2563eb' }   // è“è‰² - ç»¼åˆèµ„æº
                };
                
                const config = typeConfig[link.type] || { name: 'å…¶ä»–', color: '#8d5a2a', bgColor: '#fdfbf7', borderColor: '#8d5a2a' };
                
                return `
                    <a href="${link.url}" target="_blank" class="block bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 p-6 border-2 hover:-translate-y-1 group" style="border-color: ${config.borderColor}33;">
                        <h3 class="text-lg font-medium mb-2 transition-colors" style="color: ${config.color};">${link.name || 'æœªå‘½å'}</h3>
                        ${link.type ? `<span class="inline-block px-3 py-1 rounded-full text-xs mb-2 font-medium" style="background-color: ${config.bgColor}; color: ${config.color};">${config.name}</span>` : ''}
                        <div class="text-xs text-gray-500 break-all opacity-70 mt-2">${link.url}</div>
                    </a>
                `;
            }).join('');
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
